<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to Generate a Last Interaction Velocity Plot &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />

  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/documentation_options.js?v=00367301"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            tardis
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/Output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hdf/index.html">Hierarchical Data Format (HDF5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration (Required Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Reading Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output/index.html">Additional Outputs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../physics/intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/spectrum/index.html">Spectrum Generation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CHANGELOG.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/in_progress/index.html">Features In-Progress</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../resources/credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/code_comparison/index.html">Code Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/zreferences.html">References and Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">How to Generate a Last Interaction Velocity Plot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/io/visualization/interaction_radius_plot.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
    /* strip stderr */
    div.nboutput.container div.output_area.stderr {
        background: #fdd;
        display: none;
    }

    .launch-btn {
        background-color: #2980B9;
        border: none;
        border-radius: 4px;
        color: #fcfcfc;
        font-family: inherit;
        text-decoration: none;
        padding: 3px 8px;
        letter-spacing: 0.03em;
        display: inline-block;
        line-height: 1.5em;
    }

    .launch-btn:hover {
        background-color: #1b6391;
        color: #fcfcfc;
    }

    .launch-btn:visited {
        color: #fcfcfc;
    }

    .note-p {
        margin-bottom: 0.4em;
        line-height: 2em;
    }
</style>

<div class="admonition note">
<p class="note-p">You can interact with this notebook online: <a href="https://mybinder.org/v2/gh/tardis-sn/tardis/HEAD?filepath=docs/io/visualization/interaction_radius_plot.ipynb" class="launch-btn" target="_blank" rel="noopener noreferrer">Launch notebook</a></p>
</div><section id="How-to-Generate-a-Last-Interaction-Velocity-Plot">
<h1>How to Generate a Last Interaction Velocity Plot<a class="headerlink" href="#How-to-Generate-a-Last-Interaction-Velocity-Plot" title="Link to this heading">Â¶</a></h1>
<p>The Last Interaction Velocity Plot tracks and display the velocities at which different elements (or species) last interacted with packets in the simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We filter out warnings throughout this notebook</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Due to the large size of the Last Interaction Velocity plots in SVG format, we request output as a</span>
<span class="c1"># high-resolution PNG</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats=&#39;png2x&#39;
</pre></div>
</div>
</div>
<p>First, create and run a simulation for which you want to generate this plot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tardis</span> <span class="kn">import</span> <span class="n">run_tardis</span>
<span class="kn">from</span> <span class="nn">tardis.io.atom_data.util</span> <span class="kn">import</span> <span class="n">download_atom_data</span>

<span class="c1"># We download the atomic data needed to run the simulation</span>
<span class="n">download_atom_data</span><span class="p">(</span><span class="s1">&#39;kurucz_cd23_chianti_H_He&#39;</span><span class="p">)</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">run_tardis</span><span class="p">(</span><span class="s2">&quot;tardis_example.yml&quot;</span><span class="p">,</span> <span class="n">virtual_packet_logging</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9f0b95d5ba724b58b8789c8607d93493", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0b60ac68acc9468086b481b502c8b37f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Atomic Data kurucz_cd23_chianti_H_He already exists in /Users/sarthaksrivastava/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5. Will not download - override with force_download=True.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Reading Atomic Data from kurucz_cd23_chianti_H_He.h5 (<span class="ansi-bold">base.py</span>:655)
[<span class="ansi-bold">tardis.io.atom_data.util</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Atom Data kurucz_cd23_chianti_H_He.h5 not found in local path.
        Exists in TARDIS Data repo /Users/sarthaksrivastava/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (<span class="ansi-bold">util.py</span>:36)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (<span class="ansi-bold">base.py</span>:258)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data, linelist (<span class="ansi-bold">base.py</span>:262)
[<span class="ansi-bold">tardis.io.model.parse_density_configuration</span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]
        Number of density points larger than number of shells. Assuming inner point irrelevant (<span class="ansi-bold">parse_density_configuration.py</span>:114)
[<span class="ansi-bold">tardis.model.matter.decay</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Decaying abundances for 1123200.0 seconds (<span class="ansi-bold">decay.py</span>:101)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 1 of 20 (<span class="ansi-bold">base.py</span>:371)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a421e76138664e1f9069449a3a3d358e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "21567000f1de48e4b6453f3c54573105", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 7.942e+42 erg / s
        Luminosity absorbed  = 2.659e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_7a17b">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_7a17b_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_7a17b_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_7a17b_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_7a17b_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_7a17b_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_7a17b_row0_col0" class="data row0 col0" >9.93e+03 K</td>
      <td id="T_7a17b_row0_col1" class="data row0 col1" >1.01e+04 K</td>
      <td id="T_7a17b_row0_col2" class="data row0 col2" >0.4</td>
      <td id="T_7a17b_row0_col3" class="data row0 col3" >0.507</td>
    </tr>
    <tr>
      <th id="T_7a17b_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_7a17b_row1_col0" class="data row1 col0" >9.85e+03 K</td>
      <td id="T_7a17b_row1_col1" class="data row1 col1" >1.02e+04 K</td>
      <td id="T_7a17b_row1_col2" class="data row1 col2" >0.211</td>
      <td id="T_7a17b_row1_col3" class="data row1 col3" >0.197</td>
    </tr>
    <tr>
      <th id="T_7a17b_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_7a17b_row2_col0" class="data row2 col0" >9.78e+03 K</td>
      <td id="T_7a17b_row2_col1" class="data row2 col1" >1.01e+04 K</td>
      <td id="T_7a17b_row2_col2" class="data row2 col2" >0.143</td>
      <td id="T_7a17b_row2_col3" class="data row2 col3" >0.117</td>
    </tr>
    <tr>
      <th id="T_7a17b_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_7a17b_row3_col0" class="data row3 col0" >9.71e+03 K</td>
      <td id="T_7a17b_row3_col1" class="data row3 col1" >9.87e+03 K</td>
      <td id="T_7a17b_row3_col2" class="data row3 col2" >0.105</td>
      <td id="T_7a17b_row3_col3" class="data row3 col3" >0.0869</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 9933.952 K
        Expected t_inner for next iteration = 10703.212 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 2 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.071e+43 erg / s
        Luminosity absorbed  = 3.576e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_82920">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_82920_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_82920_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_82920_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_82920_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_82920_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_82920_row0_col0" class="data row0 col0" >1.01e+04 K</td>
      <td id="T_82920_row0_col1" class="data row0 col1" >1.08e+04 K</td>
      <td id="T_82920_row0_col2" class="data row0 col2" >0.507</td>
      <td id="T_82920_row0_col3" class="data row0 col3" >0.525</td>
    </tr>
    <tr>
      <th id="T_82920_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_82920_row1_col0" class="data row1 col0" >1.02e+04 K</td>
      <td id="T_82920_row1_col1" class="data row1 col1" >1.1e+04 K</td>
      <td id="T_82920_row1_col2" class="data row1 col2" >0.197</td>
      <td id="T_82920_row1_col3" class="data row1 col3" >0.203</td>
    </tr>
    <tr>
      <th id="T_82920_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_82920_row2_col0" class="data row2 col0" >1.01e+04 K</td>
      <td id="T_82920_row2_col1" class="data row2 col1" >1.08e+04 K</td>
      <td id="T_82920_row2_col2" class="data row2 col2" >0.117</td>
      <td id="T_82920_row2_col3" class="data row2 col3" >0.125</td>
    </tr>
    <tr>
      <th id="T_82920_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_82920_row3_col0" class="data row3 col0" >9.87e+03 K</td>
      <td id="T_82920_row3_col1" class="data row3 col1" >1.05e+04 K</td>
      <td id="T_82920_row3_col2" class="data row3 col2" >0.0869</td>
      <td id="T_82920_row3_col3" class="data row3 col3" >0.0933</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10703.212 K
        Expected t_inner for next iteration = 10673.712 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 3 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.074e+43 erg / s
        Luminosity absorbed  = 3.391e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 1/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_d828e">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_d828e_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_d828e_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_d828e_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_d828e_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d828e_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_d828e_row0_col0" class="data row0 col0" >1.08e+04 K</td>
      <td id="T_d828e_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_d828e_row0_col2" class="data row0 col2" >0.525</td>
      <td id="T_d828e_row0_col3" class="data row0 col3" >0.483</td>
    </tr>
    <tr>
      <th id="T_d828e_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_d828e_row1_col0" class="data row1 col0" >1.1e+04 K</td>
      <td id="T_d828e_row1_col1" class="data row1 col1" >1.12e+04 K</td>
      <td id="T_d828e_row1_col2" class="data row1 col2" >0.203</td>
      <td id="T_d828e_row1_col3" class="data row1 col3" >0.189</td>
    </tr>
    <tr>
      <th id="T_d828e_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_d828e_row2_col0" class="data row2 col0" >1.08e+04 K</td>
      <td id="T_d828e_row2_col1" class="data row2 col1" >1.1e+04 K</td>
      <td id="T_d828e_row2_col2" class="data row2 col2" >0.125</td>
      <td id="T_d828e_row2_col3" class="data row2 col3" >0.118</td>
    </tr>
    <tr>
      <th id="T_d828e_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_d828e_row3_col0" class="data row3 col0" >1.05e+04 K</td>
      <td id="T_d828e_row3_col1" class="data row3 col1" >1.06e+04 K</td>
      <td id="T_d828e_row3_col2" class="data row3 col2" >0.0933</td>
      <td id="T_d828e_row3_col3" class="data row3 col3" >0.0895</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10673.712 K
        Expected t_inner for next iteration = 10635.953 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 4 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.058e+43 erg / s
        Luminosity absorbed  = 3.352e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 2/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_ff350">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_ff350_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_ff350_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_ff350_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_ff350_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_ff350_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_ff350_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_ff350_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_ff350_row0_col2" class="data row0 col2" >0.483</td>
      <td id="T_ff350_row0_col3" class="data row0 col3" >0.469</td>
    </tr>
    <tr>
      <th id="T_ff350_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_ff350_row1_col0" class="data row1 col0" >1.12e+04 K</td>
      <td id="T_ff350_row1_col1" class="data row1 col1" >1.12e+04 K</td>
      <td id="T_ff350_row1_col2" class="data row1 col2" >0.189</td>
      <td id="T_ff350_row1_col3" class="data row1 col3" >0.182</td>
    </tr>
    <tr>
      <th id="T_ff350_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_ff350_row2_col0" class="data row2 col0" >1.1e+04 K</td>
      <td id="T_ff350_row2_col1" class="data row2 col1" >1.1e+04 K</td>
      <td id="T_ff350_row2_col2" class="data row2 col2" >0.118</td>
      <td id="T_ff350_row2_col3" class="data row2 col3" >0.113</td>
    </tr>
    <tr>
      <th id="T_ff350_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_ff350_row3_col0" class="data row3 col0" >1.06e+04 K</td>
      <td id="T_ff350_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_ff350_row3_col2" class="data row3 col2" >0.0895</td>
      <td id="T_ff350_row3_col3" class="data row3 col3" >0.0861</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10635.953 K
        Expected t_inner for next iteration = 10638.407 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 5 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.055e+43 erg / s
        Luminosity absorbed  = 3.399e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 3/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_b9439">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_b9439_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_b9439_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_b9439_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_b9439_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_b9439_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_b9439_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_b9439_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_b9439_row0_col2" class="data row0 col2" >0.469</td>
      <td id="T_b9439_row0_col3" class="data row0 col3" >0.479</td>
    </tr>
    <tr>
      <th id="T_b9439_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_b9439_row1_col0" class="data row1 col0" >1.12e+04 K</td>
      <td id="T_b9439_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_b9439_row1_col2" class="data row1 col2" >0.182</td>
      <td id="T_b9439_row1_col3" class="data row1 col3" >0.178</td>
    </tr>
    <tr>
      <th id="T_b9439_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_b9439_row2_col0" class="data row2 col0" >1.1e+04 K</td>
      <td id="T_b9439_row2_col1" class="data row2 col1" >1.1e+04 K</td>
      <td id="T_b9439_row2_col2" class="data row2 col2" >0.113</td>
      <td id="T_b9439_row2_col3" class="data row2 col3" >0.113</td>
    </tr>
    <tr>
      <th id="T_b9439_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_b9439_row3_col0" class="data row3 col0" >1.07e+04 K</td>
      <td id="T_b9439_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_b9439_row3_col2" class="data row3 col2" >0.0861</td>
      <td id="T_b9439_row3_col3" class="data row3 col3" >0.0839</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10638.407 K
        Expected t_inner for next iteration = 10650.202 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 6 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.061e+43 erg / s
        Luminosity absorbed  = 3.398e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 4/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_18b2b">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_18b2b_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_18b2b_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_18b2b_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_18b2b_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_18b2b_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_18b2b_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_18b2b_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_18b2b_row0_col2" class="data row0 col2" >0.479</td>
      <td id="T_18b2b_row0_col3" class="data row0 col3" >0.47</td>
    </tr>
    <tr>
      <th id="T_18b2b_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_18b2b_row1_col0" class="data row1 col0" >1.13e+04 K</td>
      <td id="T_18b2b_row1_col1" class="data row1 col1" >1.12e+04 K</td>
      <td id="T_18b2b_row1_col2" class="data row1 col2" >0.178</td>
      <td id="T_18b2b_row1_col3" class="data row1 col3" >0.185</td>
    </tr>
    <tr>
      <th id="T_18b2b_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_18b2b_row2_col0" class="data row2 col0" >1.1e+04 K</td>
      <td id="T_18b2b_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_18b2b_row2_col2" class="data row2 col2" >0.113</td>
      <td id="T_18b2b_row2_col3" class="data row2 col3" >0.112</td>
    </tr>
    <tr>
      <th id="T_18b2b_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_18b2b_row3_col0" class="data row3 col0" >1.07e+04 K</td>
      <td id="T_18b2b_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_18b2b_row3_col2" class="data row3 col2" >0.0839</td>
      <td id="T_18b2b_row3_col3" class="data row3 col3" >0.0856</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10650.202 K
        Expected t_inner for next iteration = 10645.955 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 7 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.061e+43 erg / s
        Luminosity absorbed  = 3.382e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 5/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_66223">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_66223_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_66223_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_66223_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_66223_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_66223_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_66223_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_66223_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_66223_row0_col2" class="data row0 col2" >0.47</td>
      <td id="T_66223_row0_col3" class="data row0 col3" >0.47</td>
    </tr>
    <tr>
      <th id="T_66223_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_66223_row1_col0" class="data row1 col0" >1.12e+04 K</td>
      <td id="T_66223_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_66223_row1_col2" class="data row1 col2" >0.185</td>
      <td id="T_66223_row1_col3" class="data row1 col3" >0.178</td>
    </tr>
    <tr>
      <th id="T_66223_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_66223_row2_col0" class="data row2 col0" >1.11e+04 K</td>
      <td id="T_66223_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_66223_row2_col2" class="data row2 col2" >0.112</td>
      <td id="T_66223_row2_col3" class="data row2 col3" >0.112</td>
    </tr>
    <tr>
      <th id="T_66223_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_66223_row3_col0" class="data row3 col0" >1.07e+04 K</td>
      <td id="T_66223_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_66223_row3_col2" class="data row3 col2" >0.0856</td>
      <td id="T_66223_row3_col3" class="data row3 col3" >0.086</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10645.955 K
        Expected t_inner for next iteration = 10642.050 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 8 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.062e+43 erg / s
        Luminosity absorbed  = 3.350e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 6/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_543ac">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_543ac_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_543ac_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_543ac_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_543ac_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_543ac_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_543ac_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_543ac_row0_col1" class="data row0 col1" >1.11e+04 K</td>
      <td id="T_543ac_row0_col2" class="data row0 col2" >0.47</td>
      <td id="T_543ac_row0_col3" class="data row0 col3" >0.472</td>
    </tr>
    <tr>
      <th id="T_543ac_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_543ac_row1_col0" class="data row1 col0" >1.13e+04 K</td>
      <td id="T_543ac_row1_col1" class="data row1 col1" >1.14e+04 K</td>
      <td id="T_543ac_row1_col2" class="data row1 col2" >0.178</td>
      <td id="T_543ac_row1_col3" class="data row1 col3" >0.175</td>
    </tr>
    <tr>
      <th id="T_543ac_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_543ac_row2_col0" class="data row2 col0" >1.11e+04 K</td>
      <td id="T_543ac_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_543ac_row2_col2" class="data row2 col2" >0.112</td>
      <td id="T_543ac_row2_col3" class="data row2 col3" >0.111</td>
    </tr>
    <tr>
      <th id="T_543ac_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_543ac_row3_col0" class="data row3 col0" >1.07e+04 K</td>
      <td id="T_543ac_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_543ac_row3_col2" class="data row3 col2" >0.086</td>
      <td id="T_543ac_row3_col3" class="data row3 col3" >0.084</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10642.050 K
        Expected t_inner for next iteration = 10636.106 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 9 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.052e+43 erg / s
        Luminosity absorbed  = 3.411e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 7/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_4a41c">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_4a41c_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_4a41c_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_4a41c_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_4a41c_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_4a41c_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_4a41c_row0_col0" class="data row0 col0" >1.11e+04 K</td>
      <td id="T_4a41c_row0_col1" class="data row0 col1" >1.11e+04 K</td>
      <td id="T_4a41c_row0_col2" class="data row0 col2" >0.472</td>
      <td id="T_4a41c_row0_col3" class="data row0 col3" >0.469</td>
    </tr>
    <tr>
      <th id="T_4a41c_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_4a41c_row1_col0" class="data row1 col0" >1.14e+04 K</td>
      <td id="T_4a41c_row1_col1" class="data row1 col1" >1.15e+04 K</td>
      <td id="T_4a41c_row1_col2" class="data row1 col2" >0.175</td>
      <td id="T_4a41c_row1_col3" class="data row1 col3" >0.17</td>
    </tr>
    <tr>
      <th id="T_4a41c_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_4a41c_row2_col0" class="data row2 col0" >1.11e+04 K</td>
      <td id="T_4a41c_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_4a41c_row2_col2" class="data row2 col2" >0.111</td>
      <td id="T_4a41c_row2_col3" class="data row2 col3" >0.109</td>
    </tr>
    <tr>
      <th id="T_4a41c_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_4a41c_row3_col0" class="data row3 col0" >1.07e+04 K</td>
      <td id="T_4a41c_row3_col1" class="data row3 col1" >1.08e+04 K</td>
      <td id="T_4a41c_row3_col2" class="data row3 col2" >0.084</td>
      <td id="T_4a41c_row3_col3" class="data row3 col3" >0.0822</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10636.106 K
        Expected t_inner for next iteration = 10654.313 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 10 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.070e+43 erg / s
        Luminosity absorbed  = 3.335e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 8/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_3f6ef">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_3f6ef_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_3f6ef_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_3f6ef_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_3f6ef_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_3f6ef_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_3f6ef_row0_col0" class="data row0 col0" >1.11e+04 K</td>
      <td id="T_3f6ef_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_3f6ef_row0_col2" class="data row0 col2" >0.469</td>
      <td id="T_3f6ef_row0_col3" class="data row0 col3" >0.475</td>
    </tr>
    <tr>
      <th id="T_3f6ef_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_3f6ef_row1_col0" class="data row1 col0" >1.15e+04 K</td>
      <td id="T_3f6ef_row1_col1" class="data row1 col1" >1.14e+04 K</td>
      <td id="T_3f6ef_row1_col2" class="data row1 col2" >0.17</td>
      <td id="T_3f6ef_row1_col3" class="data row1 col3" >0.177</td>
    </tr>
    <tr>
      <th id="T_3f6ef_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_3f6ef_row2_col0" class="data row2 col0" >1.11e+04 K</td>
      <td id="T_3f6ef_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_3f6ef_row2_col2" class="data row2 col2" >0.109</td>
      <td id="T_3f6ef_row2_col3" class="data row2 col3" >0.112</td>
    </tr>
    <tr>
      <th id="T_3f6ef_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_3f6ef_row3_col0" class="data row3 col0" >1.08e+04 K</td>
      <td id="T_3f6ef_row3_col1" class="data row3 col1" >1.06e+04 K</td>
      <td id="T_3f6ef_row3_col2" class="data row3 col2" >0.0822</td>
      <td id="T_3f6ef_row3_col3" class="data row3 col3" >0.0878</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10654.313 K
        Expected t_inner for next iteration = 10628.190 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 11 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.053e+43 erg / s
        Luminosity absorbed  = 3.363e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 9/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_f16cd">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_f16cd_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_f16cd_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_f16cd_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_f16cd_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_f16cd_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_f16cd_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_f16cd_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_f16cd_row0_col2" class="data row0 col2" >0.475</td>
      <td id="T_f16cd_row0_col3" class="data row0 col3" >0.472</td>
    </tr>
    <tr>
      <th id="T_f16cd_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_f16cd_row1_col0" class="data row1 col0" >1.14e+04 K</td>
      <td id="T_f16cd_row1_col1" class="data row1 col1" >1.12e+04 K</td>
      <td id="T_f16cd_row1_col2" class="data row1 col2" >0.177</td>
      <td id="T_f16cd_row1_col3" class="data row1 col3" >0.184</td>
    </tr>
    <tr>
      <th id="T_f16cd_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_f16cd_row2_col0" class="data row2 col0" >1.11e+04 K</td>
      <td id="T_f16cd_row2_col1" class="data row2 col1" >1.1e+04 K</td>
      <td id="T_f16cd_row2_col2" class="data row2 col2" >0.112</td>
      <td id="T_f16cd_row2_col3" class="data row2 col3" >0.114</td>
    </tr>
    <tr>
      <th id="T_f16cd_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_f16cd_row3_col0" class="data row3 col0" >1.06e+04 K</td>
      <td id="T_f16cd_row3_col1" class="data row3 col1" >1.06e+04 K</td>
      <td id="T_f16cd_row3_col2" class="data row3 col2" >0.0878</td>
      <td id="T_f16cd_row3_col3" class="data row3 col3" >0.0859</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10628.190 K
        Expected t_inner for next iteration = 10644.054 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 12 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.056e+43 erg / s
        Luminosity absorbed  = 3.420e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 10/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_a6615">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_a6615_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_a6615_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_a6615_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_a6615_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_a6615_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_a6615_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_a6615_row0_col1" class="data row0 col1" >1.11e+04 K</td>
      <td id="T_a6615_row0_col2" class="data row0 col2" >0.472</td>
      <td id="T_a6615_row0_col3" class="data row0 col3" >0.467</td>
    </tr>
    <tr>
      <th id="T_a6615_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_a6615_row1_col0" class="data row1 col0" >1.12e+04 K</td>
      <td id="T_a6615_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_a6615_row1_col2" class="data row1 col2" >0.184</td>
      <td id="T_a6615_row1_col3" class="data row1 col3" >0.176</td>
    </tr>
    <tr>
      <th id="T_a6615_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_a6615_row2_col0" class="data row2 col0" >1.1e+04 K</td>
      <td id="T_a6615_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_a6615_row2_col2" class="data row2 col2" >0.114</td>
      <td id="T_a6615_row2_col3" class="data row2 col3" >0.11</td>
    </tr>
    <tr>
      <th id="T_a6615_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_a6615_row3_col0" class="data row3 col0" >1.06e+04 K</td>
      <td id="T_a6615_row3_col1" class="data row3 col1" >1.08e+04 K</td>
      <td id="T_a6615_row3_col2" class="data row3 col2" >0.0859</td>
      <td id="T_a6615_row3_col3" class="data row3 col3" >0.0821</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10644.054 K
        Expected t_inner for next iteration = 10653.543 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 13 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.062e+43 erg / s
        Luminosity absorbed  = 3.406e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 11/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_fd18f">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_fd18f_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_fd18f_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_fd18f_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_fd18f_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_fd18f_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_fd18f_row0_col0" class="data row0 col0" >1.11e+04 K</td>
      <td id="T_fd18f_row0_col1" class="data row0 col1" >1.11e+04 K</td>
      <td id="T_fd18f_row0_col2" class="data row0 col2" >0.467</td>
      <td id="T_fd18f_row0_col3" class="data row0 col3" >0.466</td>
    </tr>
    <tr>
      <th id="T_fd18f_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_fd18f_row1_col0" class="data row1 col0" >1.13e+04 K</td>
      <td id="T_fd18f_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_fd18f_row1_col2" class="data row1 col2" >0.176</td>
      <td id="T_fd18f_row1_col3" class="data row1 col3" >0.18</td>
    </tr>
    <tr>
      <th id="T_fd18f_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_fd18f_row2_col0" class="data row2 col0" >1.11e+04 K</td>
      <td id="T_fd18f_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_fd18f_row2_col2" class="data row2 col2" >0.11</td>
      <td id="T_fd18f_row2_col3" class="data row2 col3" >0.111</td>
    </tr>
    <tr>
      <th id="T_fd18f_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_fd18f_row3_col0" class="data row3 col0" >1.08e+04 K</td>
      <td id="T_fd18f_row3_col1" class="data row3 col1" >1.08e+04 K</td>
      <td id="T_fd18f_row3_col2" class="data row3 col2" >0.0821</td>
      <td id="T_fd18f_row3_col3" class="data row3 col3" >0.0841</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10653.543 K
        Expected t_inner for next iteration = 10647.277 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 14 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.063e+43 erg / s
        Luminosity absorbed  = 3.369e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 12/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_cabec">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_cabec_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_cabec_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_cabec_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_cabec_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_cabec_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_cabec_row0_col0" class="data row0 col0" >1.11e+04 K</td>
      <td id="T_cabec_row0_col1" class="data row0 col1" >1.11e+04 K</td>
      <td id="T_cabec_row0_col2" class="data row0 col2" >0.466</td>
      <td id="T_cabec_row0_col3" class="data row0 col3" >0.469</td>
    </tr>
    <tr>
      <th id="T_cabec_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_cabec_row1_col0" class="data row1 col0" >1.13e+04 K</td>
      <td id="T_cabec_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_cabec_row1_col2" class="data row1 col2" >0.18</td>
      <td id="T_cabec_row1_col3" class="data row1 col3" >0.182</td>
    </tr>
    <tr>
      <th id="T_cabec_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_cabec_row2_col0" class="data row2 col0" >1.11e+04 K</td>
      <td id="T_cabec_row2_col1" class="data row2 col1" >1.1e+04 K</td>
      <td id="T_cabec_row2_col2" class="data row2 col2" >0.111</td>
      <td id="T_cabec_row2_col3" class="data row2 col3" >0.113</td>
    </tr>
    <tr>
      <th id="T_cabec_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_cabec_row3_col0" class="data row3 col0" >1.08e+04 K</td>
      <td id="T_cabec_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_cabec_row3_col2" class="data row3 col2" >0.0841</td>
      <td id="T_cabec_row3_col3" class="data row3 col3" >0.0854</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10647.277 K
        Expected t_inner for next iteration = 10638.875 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 15 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.053e+43 erg / s
        Luminosity absorbed  = 3.417e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 13/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_388af">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_388af_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_388af_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_388af_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_388af_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_388af_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_388af_row0_col0" class="data row0 col0" >1.11e+04 K</td>
      <td id="T_388af_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_388af_row0_col2" class="data row0 col2" >0.469</td>
      <td id="T_388af_row0_col3" class="data row0 col3" >0.484</td>
    </tr>
    <tr>
      <th id="T_388af_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_388af_row1_col0" class="data row1 col0" >1.13e+04 K</td>
      <td id="T_388af_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_388af_row1_col2" class="data row1 col2" >0.182</td>
      <td id="T_388af_row1_col3" class="data row1 col3" >0.181</td>
    </tr>
    <tr>
      <th id="T_388af_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_388af_row2_col0" class="data row2 col0" >1.1e+04 K</td>
      <td id="T_388af_row2_col1" class="data row2 col1" >1.1e+04 K</td>
      <td id="T_388af_row2_col2" class="data row2 col2" >0.113</td>
      <td id="T_388af_row2_col3" class="data row2 col3" >0.113</td>
    </tr>
    <tr>
      <th id="T_388af_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_388af_row3_col0" class="data row3 col0" >1.07e+04 K</td>
      <td id="T_388af_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_388af_row3_col2" class="data row3 col2" >0.0854</td>
      <td id="T_388af_row3_col3" class="data row3 col3" >0.0858</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10638.875 K
        Expected t_inner for next iteration = 10655.125 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 16 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.059e+43 erg / s
        Luminosity absorbed  = 3.445e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 14/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_4ce44">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_4ce44_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_4ce44_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_4ce44_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_4ce44_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_4ce44_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_4ce44_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_4ce44_row0_col1" class="data row0 col1" >1.1e+04 K</td>
      <td id="T_4ce44_row0_col2" class="data row0 col2" >0.484</td>
      <td id="T_4ce44_row0_col3" class="data row0 col3" >0.472</td>
    </tr>
    <tr>
      <th id="T_4ce44_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_4ce44_row1_col0" class="data row1 col0" >1.13e+04 K</td>
      <td id="T_4ce44_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_4ce44_row1_col2" class="data row1 col2" >0.181</td>
      <td id="T_4ce44_row1_col3" class="data row1 col3" >0.177</td>
    </tr>
    <tr>
      <th id="T_4ce44_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_4ce44_row2_col0" class="data row2 col0" >1.1e+04 K</td>
      <td id="T_4ce44_row2_col1" class="data row2 col1" >1.1e+04 K</td>
      <td id="T_4ce44_row2_col2" class="data row2 col2" >0.113</td>
      <td id="T_4ce44_row2_col3" class="data row2 col3" >0.113</td>
    </tr>
    <tr>
      <th id="T_4ce44_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_4ce44_row3_col0" class="data row3 col0" >1.07e+04 K</td>
      <td id="T_4ce44_row3_col1" class="data row3 col1" >1.06e+04 K</td>
      <td id="T_4ce44_row3_col2" class="data row3 col2" >0.0858</td>
      <td id="T_4ce44_row3_col3" class="data row3 col3" >0.0858</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10655.125 K
        Expected t_inner for next iteration = 10655.561 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 17 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.067e+43 erg / s
        Luminosity absorbed  = 3.372e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 15/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_e88e3">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_e88e3_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_e88e3_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_e88e3_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_e88e3_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e88e3_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_e88e3_row0_col0" class="data row0 col0" >1.1e+04 K</td>
      <td id="T_e88e3_row0_col1" class="data row0 col1" >1.11e+04 K</td>
      <td id="T_e88e3_row0_col2" class="data row0 col2" >0.472</td>
      <td id="T_e88e3_row0_col3" class="data row0 col3" >0.468</td>
    </tr>
    <tr>
      <th id="T_e88e3_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_e88e3_row1_col0" class="data row1 col0" >1.13e+04 K</td>
      <td id="T_e88e3_row1_col1" class="data row1 col1" >1.14e+04 K</td>
      <td id="T_e88e3_row1_col2" class="data row1 col2" >0.177</td>
      <td id="T_e88e3_row1_col3" class="data row1 col3" >0.175</td>
    </tr>
    <tr>
      <th id="T_e88e3_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_e88e3_row2_col0" class="data row2 col0" >1.1e+04 K</td>
      <td id="T_e88e3_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_e88e3_row2_col2" class="data row2 col2" >0.113</td>
      <td id="T_e88e3_row2_col3" class="data row2 col3" >0.11</td>
    </tr>
    <tr>
      <th id="T_e88e3_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_e88e3_row3_col0" class="data row3 col0" >1.06e+04 K</td>
      <td id="T_e88e3_row3_col1" class="data row3 col1" >1.08e+04 K</td>
      <td id="T_e88e3_row3_col2" class="data row3 col2" >0.0858</td>
      <td id="T_e88e3_row3_col3" class="data row3 col3" >0.0816</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10655.561 K
        Expected t_inner for next iteration = 10636.536 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 18 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.057e+43 erg / s
        Luminosity absorbed  = 3.365e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 16/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_b60d0">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_b60d0_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_b60d0_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_b60d0_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_b60d0_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_b60d0_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_b60d0_row0_col0" class="data row0 col0" >1.11e+04 K</td>
      <td id="T_b60d0_row0_col1" class="data row0 col1" >1.11e+04 K</td>
      <td id="T_b60d0_row0_col2" class="data row0 col2" >0.468</td>
      <td id="T_b60d0_row0_col3" class="data row0 col3" >0.464</td>
    </tr>
    <tr>
      <th id="T_b60d0_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_b60d0_row1_col0" class="data row1 col0" >1.14e+04 K</td>
      <td id="T_b60d0_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_b60d0_row1_col2" class="data row1 col2" >0.175</td>
      <td id="T_b60d0_row1_col3" class="data row1 col3" >0.177</td>
    </tr>
    <tr>
      <th id="T_b60d0_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_b60d0_row2_col0" class="data row2 col0" >1.11e+04 K</td>
      <td id="T_b60d0_row2_col1" class="data row2 col1" >1.1e+04 K</td>
      <td id="T_b60d0_row2_col2" class="data row2 col2" >0.11</td>
      <td id="T_b60d0_row2_col3" class="data row2 col3" >0.113</td>
    </tr>
    <tr>
      <th id="T_b60d0_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_b60d0_row3_col0" class="data row3 col0" >1.08e+04 K</td>
      <td id="T_b60d0_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_b60d0_row3_col2" class="data row3 col2" >0.0816</td>
      <td id="T_b60d0_row3_col3" class="data row3 col3" >0.0848</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10636.536 K
        Expected t_inner for next iteration = 10641.692 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 19 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.056e+43 erg / s
        Luminosity absorbed  = 3.405e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]
        Iteration converged 17/4 consecutive times. (<span class="ansi-bold">base.py</span>:245)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Plasma stratification: (<span class="ansi-bold">base.py</span>:521)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_71a88">
  <thead>
    <tr>
      <th class="index_name level0" >Shell No.</th>
      <th id="T_71a88_level0_col0" class="col_heading level0 col0" >t_rad</th>
      <th id="T_71a88_level0_col1" class="col_heading level0 col1" >next_t_rad</th>
      <th id="T_71a88_level0_col2" class="col_heading level0 col2" >w</th>
      <th id="T_71a88_level0_col3" class="col_heading level0 col3" >next_w</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_71a88_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_71a88_row0_col0" class="data row0 col0" >1.11e+04 K</td>
      <td id="T_71a88_row0_col1" class="data row0 col1" >1.11e+04 K</td>
      <td id="T_71a88_row0_col2" class="data row0 col2" >0.464</td>
      <td id="T_71a88_row0_col3" class="data row0 col3" >0.466</td>
    </tr>
    <tr>
      <th id="T_71a88_level0_row1" class="row_heading level0 row1" >5</th>
      <td id="T_71a88_row1_col0" class="data row1 col0" >1.13e+04 K</td>
      <td id="T_71a88_row1_col1" class="data row1 col1" >1.13e+04 K</td>
      <td id="T_71a88_row1_col2" class="data row1 col2" >0.177</td>
      <td id="T_71a88_row1_col3" class="data row1 col3" >0.177</td>
    </tr>
    <tr>
      <th id="T_71a88_level0_row2" class="row_heading level0 row2" >10</th>
      <td id="T_71a88_row2_col0" class="data row2 col0" >1.1e+04 K</td>
      <td id="T_71a88_row2_col1" class="data row2 col1" >1.11e+04 K</td>
      <td id="T_71a88_row2_col2" class="data row2 col2" >0.113</td>
      <td id="T_71a88_row2_col3" class="data row2 col3" >0.111</td>
    </tr>
    <tr>
      <th id="T_71a88_level0_row3" class="row_heading level0 row3" >15</th>
      <td id="T_71a88_row3_col0" class="data row3 col0" >1.07e+04 K</td>
      <td id="T_71a88_row3_col1" class="data row3 col1" >1.07e+04 K</td>
      <td id="T_71a88_row3_col2" class="data row3 col2" >0.0848</td>
      <td id="T_71a88_row3_col3" class="data row3 col3" >0.0853</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Current t_inner = 10641.692 K
        Expected t_inner for next iteration = 10650.463 K
 (<span class="ansi-bold">base.py</span>:548)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Simulation finished in 19 iterations
        Simulation took 51.93 s
 (<span class="ansi-bold">base.py</span>:449)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Starting iteration 20 of 20 (<span class="ansi-bold">base.py</span>:371)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]

        Luminosity emitted   = 1.061e+43 erg / s
        Luminosity absorbed  = 3.401e+42 erg / s
        Luminosity requested = 1.059e+43 erg / s
 (<span class="ansi-bold">base.py</span>:553)
</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Note</p>
<p>The virtual packet logging capability must be active in order to produce the Last Interaction Velocity Plot for virtual packets population. Thus, make sure to set <code class="docutils literal notranslate"><span class="pre">virtual_packet_logging:</span> <span class="pre">True</span></code> in your configuration file if you want to generate the Last Interaction Velocity Plot with virtual packets. It should be added under the <code class="docutils literal notranslate"><span class="pre">virtual</span></code> property of the <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> property, as described in the <a class="reference external" href="https://tardis-sn.github.io/tardis/io/configuration/components/spectrum.html">configuration
schema</a>.</p>
</div>
<p>Now, import the plotting interface for Last Interaction Velocity Plot, i.e. the <code class="docutils literal notranslate"><span class="pre">InteractionRadiusPlotter</span></code> class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tardis.visualization.tools.interaction_radius_plot</span> <span class="kn">import</span> <span class="n">InteractionRadiusPlotter</span>
</pre></div>
</div>
</div>
<p>And create a plotter object to process the data of simulation object <code class="docutils literal notranslate"><span class="pre">sim</span></code> for generating the Last Interaction Velocity plot.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">InteractionRadiusPlotter</span><span class="o">.</span><span class="n">from_simulation</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Choosing-what-elements/ions-to-plot">
<h2>Choosing what elements/ions to plot<a class="headerlink" href="#Choosing-what-elements/ions-to-plot" title="Link to this heading">Â¶</a></h2>
<p>You need to create a species_list for the species you want plotted in the Last Interaction Velocity Plot. Valid options include elements (e.g., Si), ions (specified in Roman numeral format, e.g., Si II), a range of ions (e.g., Si I-III), or any combination of these.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<section id="Static-Plot-(in-matplotlib)">
<h3>Static Plot (in matplotlib)<a class="headerlink" href="#Static-Plot-(in-matplotlib)" title="Link to this heading">Â¶</a></h3>
<p>You can now call the <code class="docutils literal notranslate"><span class="pre">generate_plot_mpl()</span></code> method on your <code class="docutils literal notranslate"><span class="pre">plotter</span></code> object to get a highly informative, yet beautiful, Last Interaction Velocity plot produced in matplotlib.</p>
</section>
</section>
<section id="Virtual-packets-mode">
<h2>Virtual packets mode<a class="headerlink" href="#Virtual-packets-mode" title="Link to this heading">Â¶</a></h2>
<p>By default, an Velocity Pracket Tracker plot is produced for the virtual packet population of the simulation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">species_list</span><span class="o">=</span><span class="n">species_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;Last Interaction Velocity (km/s)&#39;, ylabel=&#39;Packet Count&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/io_visualization_interaction_radius_plot_14_1.png" class="no-scaled-link" src="../../_images/io_visualization_interaction_radius_plot_14_1.png" style="width: 1090px; height: 489px;" />
</div>
</div>
</section>
<section id="Real-packets-mode">
<h2>Real packets mode<a class="headerlink" href="#Real-packets-mode" title="Link to this heading">Â¶</a></h2>
<p>You can produce the Last Interaction Velocity plot for the real packet population of the simulation by setting <code class="docutils literal notranslate"><span class="pre">packets_mode=&quot;real&quot;</span></code> which is <code class="docutils literal notranslate"><span class="pre">&quot;virtual&quot;</span></code> by default.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">packets_mode</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">,</span> <span class="n">species_list</span><span class="o">=</span><span class="n">species_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;Last Interaction Velocity (km/s)&#39;, ylabel=&#39;Packet Count&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/io_visualization_interaction_radius_plot_16_1.png" class="no-scaled-link" src="../../_images/io_visualization_interaction_radius_plot_16_1.png" style="width: 1090px; height: 489px;" />
</div>
</div>
<section id="Plotting-a-specific-number-of-bins">
<h3>Plotting a specific number of bins<a class="headerlink" href="#Plotting-a-specific-number-of-bins" title="Link to this heading">Â¶</a></h3>
<p>You can regroup the bins with broader widths within the same velocity range using <code class="docutils literal notranslate"><span class="pre">num_bins</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">species_list</span><span class="o">=</span><span class="n">species_list</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;Last Interaction Velocity (km/s)&#39;, ylabel=&#39;Packet Count&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/io_visualization_interaction_radius_plot_18_1.png" class="no-scaled-link" src="../../_images/io_visualization_interaction_radius_plot_18_1.png" style="width: 1090px; height: 489px;" />
</div>
</div>
</section>
<section id="Plotting-a-specific-velocity-range">
<h3>Plotting a specific velocity range<a class="headerlink" href="#Plotting-a-specific-velocity-range" title="Link to this heading">Â¶</a></h3>
<p>You can restrict the range of bins to plot in the interaction radius plot by specifying <code class="docutils literal notranslate"><span class="pre">velocity_range</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">species_list</span><span class="o">=</span><span class="n">species_list</span><span class="p">,</span> <span class="n">velocity_range</span><span class="o">=</span><span class="p">(</span><span class="mi">12500</span><span class="p">,</span> <span class="mi">15050</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;Last Interaction Velocity (km/s)&#39;, ylabel=&#39;Packet Count&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/io_visualization_interaction_radius_plot_20_1.png" class="no-scaled-link" src="../../_images/io_visualization_interaction_radius_plot_20_1.png" style="width: 1090px; height: 489px;" />
</div>
</div>
</section>
<section id="Additional-plotting-options">
<h3>Additional plotting options<a class="headerlink" href="#Additional-plotting-options" title="Link to this heading">Â¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">generate_plot_mpl</span></code> method also has options specific to the matplotlib API, thereby providing you with more control over how your interaction radius plot looks. Possible cases where you may use them are: - <code class="docutils literal notranslate"><span class="pre">ax</span></code>: To plot on an Axis of a plot youâre already working with, e.g. for subplots. - <code class="docutils literal notranslate"><span class="pre">figsize</span></code>: To resize the plot as per your requirements. - <code class="docutils literal notranslate"><span class="pre">cmapname</span></code>: To use a colormap of your preference, instead of âjetâ. - <code class="docutils literal notranslate"><span class="pre">log_scale</span></code>: To use a logarithmic scale for the axes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To list all available options (or parameters) with their description</span>
<span class="n">help</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method generate_plot_mpl in module tardis.visualization.tools.interaction_radius_plot:

generate_plot_mpl(packets_mode=&#39;virtual&#39;, ax=None, figsize=(11, 5), cmapname=&#39;jet&#39;, species_list=None, log_scale=False, num_bins=None, velocity_range=None) method of tardis.visualization.tools.interaction_radius_plot.InteractionRadiusPlotter instance
    Generate the last interaction radius distribution plot using matplotlib.

    Parameters
    ----------
    packets_mode : str, optional
        Packet mode, either &#39;virtual&#39; or &#39;real&#39;. Default is &#39;virtual&#39;.
    ax : matplotlib.axes.Axes, optional
        Axes object to plot on. If None, creates a new figure.
    figsize : tuple, optional
        Size of the figure. Default is (11, 6).
    cmapname : str, optional
        Colormap name. Default is &#39;jet&#39;. A specific colormap can be chosen, such as &#34;jet&#34;, &#34;viridis&#34;, &#34;plasma&#34;, etc.
    species_list : list of str
        List of species to plot.
    log_scale : bool, optional
        If True, both axes are scaled logarithmically. Default is False.
    num_bins : int, optional
        Number of bins for regrouping within the same range. Default is None
    xlim : tuple, optional
        Limits for the x-axis. If specified, overrides any automatically determined limits.

    Returns
    -------
    matplotlib.axes.Axes
        Axes object with the plot.

</pre></div></div>
</div>
</section>
<section id="Interactive-Plot-(in-plotly)">
<h3>Interactive Plot (in plotly)<a class="headerlink" href="#Interactive-Plot-(in-plotly)" title="Link to this heading">Â¶</a></h3>
<p>If youâre using the Last Interaction Velocity plot for exploration purposes, you should plot its interactive version by using <code class="docutils literal notranslate"><span class="pre">generate_plot_ply()</span></code>. This not only allows you to zoom &amp; pan but also to inspect data values by hovering, to resize scale, etc. conveniently (as shown below).</p>
<p><strong>This method takes the exact same arguments as ``generate_plot_mpl`` except a few that are specific to the plotting library.</strong> We can produce all the plots above in plotly, by passing the same arguments.</p>
</section>
</section>
<section id="id1">
<h2>Virtual packets mode<a class="headerlink" href="#id1" title="Link to this heading">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">species_list</span><span class="o">=</span><span class="n">species_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>Real packets mode<a class="headerlink" href="#id2" title="Link to this heading">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">packets_mode</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">,</span> <span class="n">species_list</span><span class="o">=</span><span class="n">species_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
<section id="id3">
<h3>Plotting a specific number of bins<a class="headerlink" href="#id3" title="Link to this heading">Â¶</a></h3>
<p>You can regroup the bins with broader widths within the same velocity range using <code class="docutils literal notranslate"><span class="pre">num_bins</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">species_list</span><span class="o">=</span><span class="n">species_list</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>Plotting a specific velocity range<a class="headerlink" href="#id4" title="Link to this heading">Â¶</a></h3>
<p>You can restrict the range of bins to plot in the interaction radius plot by specifying <code class="docutils literal notranslate"><span class="pre">velocity_range</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">species_list</span><span class="o">=</span><span class="n">species_list</span><span class="p">,</span> <span class="n">velocity_range</span><span class="o">=</span><span class="p">[</span><span class="mi">12500</span><span class="p">,</span> <span class="mi">15050</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>Additional plotting options<a class="headerlink" href="#id5" title="Link to this heading">Â¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">generate_plot_ply</span></code> method also has options specific to the plotly API, thereby providing you with more control over how your interaction radius plot looks. Possible cases where you may use them are: - <code class="docutils literal notranslate"><span class="pre">fig</span></code>: To plot the interaction radius plot on a figure you are already using e.g. for subplots. - <code class="docutils literal notranslate"><span class="pre">graph_height</span></code>: To specify the height of the graph as needed. - <code class="docutils literal notranslate"><span class="pre">cmapname</span></code>: To use a colormap of your preference instead of âjetâ. - <code class="docutils literal notranslate"><span class="pre">log_scale</span></code>: To use a logarithmic scale for the axes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To list all available options (or parameters) with their description</span>
<span class="n">help</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method generate_plot_ply in module tardis.visualization.tools.interaction_radius_plot:

generate_plot_ply(packets_mode=&#39;virtual&#39;, fig=None, graph_height=500, cmapname=&#39;jet&#39;, species_list=None, log_scale=False, num_bins=None, velocity_range=None) method of tardis.visualization.tools.interaction_radius_plot.InteractionRadiusPlotter instance
    Generate the last interaction radius distribution plot using plotly.

    Parameters
    ----------
    packets_mode : str, optional
        Packet mode, either &#39;virtual&#39; or &#39;real&#39;. Default is &#39;virtual&#39;.
    fig : plotly.graph_objects.Figure, optional
        Plotly figure object to add the plot to. If None, creates a new figure.
    graph_height : int, optional
        Height of the graph in pixels. Default is 500.
    cmapname : str, optional
        Colormap name. Default is &#39;jet&#39;. A specific colormap can be chosen, such as &#34;jet&#34;, &#34;viridis&#34;, &#34;plasma&#34;, etc.
    species_list : list of str
        List of species to plot.
    log_scale : bool, optional
        If True, both axes are scaled logarithmically. Default is False.
    num_bins : int, optional
        Number of bins for regrouping within the same range. Default is None
    range : tuple, optional
        Limits for the x-axis. If specified, overrides any automatically determined limits.

    Returns
    -------
    plotly.graph_objects.Figure
        Plotly figure object with the plot.

</pre></div></div>
</div>
</section>
<section id="Using-simulation-saved-as-HDF">
<h3>Using simulation saved as HDF<a class="headerlink" href="#Using-simulation-saved-as-HDF" title="Link to this heading">Â¶</a></h3>
<p>Other than producing the Last Interaction Velocity Plot for simulation objects in runtime, you can also produce it for saved TARDIS simulations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hdf_plotter = InteractionRadiusPlotter.from_hdf(&quot;demo.h5&quot;) ## Files is too large - just as an example</span>
</pre></div>
</div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">hdf_plotter</span></code> object is similar to the <code class="docutils literal notranslate"><span class="pre">plotter</span></code> object we used above, <strong>so you can use each plotting method demonstrated above with this too.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Static plot with virtual packets mode</span>
<span class="c1"># hdf_plotter.generate_plot_mpl(species_list=[&quot;Si I-III&quot;, &quot;Ca&quot;, &quot;O&quot;, &quot;S&quot;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Static plot with real packets mode</span>
<span class="c1">#hdf_plotter.generate_plot_mpl(packets_mode=&quot;real&quot;, species_list=[&quot;Si I-III&quot;, &quot;Ca&quot;, &quot;O&quot;, &quot;S&quot;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interactive plot with virtual packets mode</span>
<span class="c1"># hdf_plotter.generate_plot_ply(species_list=[&quot;Si I-III&quot;, &quot;Ca&quot;, &quot;O&quot;, &quot;S&quot;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hdf_plotter.generate_plot_ply(species_list=[&quot;Si I-III&quot;, &quot;Ca&quot;, &quot;O&quot;, &quot;S&quot;], bins_range=(3,10))</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2024, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 03 Jul 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>